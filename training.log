Using device: cuda
Loading annotations from: ../output/train.json
Loaded 82 images with annotations.
Loading model: sam2_hiera_t.yaml with checkpoint: ./checkpoints/sam2_hiera_tiny.pt
Training - Mask Decoder: True, Prompt Encoder: True, Image Encoder: False
Starting training for 1000 iterations...
Iter 0/1000 | Loss: 0.0307 (Seg: 0.0205, Score: 0.2040) | Inst IOU: 0.4236 | Mean IOU: 0.0042 | Elapsed: 00:00:01 | ETR: N/A
Iter 10/1000 | Loss: 0.0134 (Seg: 0.0063, Score: 0.1420) | Inst IOU: 0.5358 | Mean IOU: 0.0468 | Elapsed: 00:00:10 | ETR: 00:14:23
Iter 20/1000 | Loss: 0.0128 (Seg: 0.0046, Score: 0.1642) | Inst IOU: 0.4975 | Mean IOU: 0.0857 | Elapsed: 00:00:19 | ETR: 00:14:56
Iter 30/1000 | Loss: 0.0114 (Seg: 0.0043, Score: 0.1436) | Inst IOU: 0.5342 | Mean IOU: 0.1236 | Elapsed: 00:00:28 | ETR: 00:13:23
Iter 40/1000 | Loss: 0.0116 (Seg: 0.0063, Score: 0.1066) | Inst IOU: 0.5443 | Mean IOU: 0.1587 | Elapsed: 00:00:37 | ETR: 00:15:23
Iter 50/1000 | Loss: 0.0102 (Seg: 0.0052, Score: 0.0999) | Inst IOU: 0.5746 | Mean IOU: 0.1928 | Elapsed: 00:00:48 | ETR: 00:17:28
Iter 60/1000 | Loss: 0.0100 (Seg: 0.0042, Score: 0.1161) | Inst IOU: 0.5687 | Mean IOU: 0.2243 | Elapsed: 00:00:59 | ETR: 00:17:08
Iter 70/1000 | Loss: 0.0178 (Seg: 0.0107, Score: 0.1434) | Inst IOU: 0.3216 | Mean IOU: 0.2480 | Elapsed: 00:01:07 | ETR: 00:12:28
Iter 80/1000 | Loss: 0.0223 (Seg: 0.0133, Score: 0.1810) | Inst IOU: 0.4365 | Mean IOU: 0.2707 | Elapsed: 00:01:18 | ETR: 00:16:12
Iter 90/1000 | Loss: 0.0063 (Seg: 0.0028, Score: 0.0708) | Inst IOU: 0.5208 | Mean IOU: 0.2939 | Elapsed: 00:01:28 | ETR: 00:16:10
Iter 100/1000 | Loss: 0.0061 (Seg: 0.0026, Score: 0.0704) | Inst IOU: 0.5871 | Mean IOU: 0.3108 | Elapsed: 00:01:37 | ETR: 00:13:28
Iter 110/1000 | Loss: 0.0072 (Seg: 0.0039, Score: 0.0678) | Inst IOU: 0.5434 | Mean IOU: 0.3306 | Elapsed: 00:01:46 | ETR: 00:12:44
Iter 120/1000 | Loss: 0.0212 (Seg: 0.0147, Score: 0.1307) | Inst IOU: 0.4327 | Mean IOU: 0.3511 | Elapsed: 00:01:55 | ETR: 00:13:29
Iter 130/1000 | Loss: 0.0061 (Seg: 0.0035, Score: 0.0517) | Inst IOU: 0.5389 | Mean IOU: 0.3692 | Elapsed: 00:02:06 | ETR: 00:15:12
Iter 140/1000 | Loss: 0.0062 (Seg: 0.0038, Score: 0.0473) | Inst IOU: 0.5623 | Mean IOU: 0.3823 | Elapsed: 00:02:16 | ETR: 00:14:30
Iter 150/1000 | Loss: 0.0080 (Seg: 0.0042, Score: 0.0763) | Inst IOU: 0.6130 | Mean IOU: 0.3935 | Elapsed: 00:02:25 | ETR: 00:13:02
Iter 160/1000 | Loss: 0.0047 (Seg: 0.0025, Score: 0.0444) | Inst IOU: 0.5786 | Mean IOU: 0.4069 | Elapsed: 00:02:35 | ETR: 00:13:26
Iter 170/1000 | Loss: 0.0053 (Seg: 0.0032, Score: 0.0430) | Inst IOU: 0.5529 | Mean IOU: 0.4190 | Elapsed: 00:02:44 | ETR: 00:12:44
Iter 180/1000 | Loss: 0.0113 (Seg: 0.0066, Score: 0.0940) | Inst IOU: 0.3906 | Mean IOU: 0.4255 | Elapsed: 00:02:55 | ETR: 00:14:44
Iter 190/1000 | Loss: 0.0050 (Seg: 0.0030, Score: 0.0410) | Inst IOU: 0.5617 | Mean IOU: 0.4349 | Elapsed: 00:03:05 | ETR: 00:13:45
Iter 200/1000 | Loss: 0.0075 (Seg: 0.0038, Score: 0.0739) | Inst IOU: 0.4709 | Mean IOU: 0.4421 | Elapsed: 00:03:13 | ETR: 00:11:23
Iter 210/1000 | Loss: 0.0056 (Seg: 0.0038, Score: 0.0356) | Inst IOU: 0.5282 | Mean IOU: 0.4466 | Elapsed: 00:03:22 | ETR: 00:11:37
Iter 220/1000 | Loss: 0.0052 (Seg: 0.0033, Score: 0.0372) | Inst IOU: 0.5162 | Mean IOU: 0.4528 | Elapsed: 00:03:35 | ETR: 00:16:21
Iter 230/1000 | Loss: 0.0064 (Seg: 0.0038, Score: 0.0521) | Inst IOU: 0.5024 | Mean IOU: 0.4592 | Elapsed: 00:03:43 | ETR: 00:10:19
Iter 240/1000 | Loss: 0.0073 (Seg: 0.0038, Score: 0.0706) | Inst IOU: 0.4677 | Mean IOU: 0.4646 | Elapsed: 00:03:54 | ETR: 00:14:15
Iter 250/1000 | Loss: 0.0049 (Seg: 0.0026, Score: 0.0464) | Inst IOU: 0.5700 | Mean IOU: 0.4705 | Elapsed: 00:04:05 | ETR: 00:13:31
Iter 260/1000 | Loss: 0.0152 (Seg: 0.0096, Score: 0.1130) | Inst IOU: 0.3979 | Mean IOU: 0.4749 | Elapsed: 00:04:15 | ETR: 00:12:48
Iter 270/1000 | Loss: 0.0049 (Seg: 0.0022, Score: 0.0535) | Inst IOU: 0.5666 | Mean IOU: 0.4776 | Elapsed: 00:04:25 | ETR: 00:11:41
Iter 280/1000 | Loss: 0.0060 (Seg: 0.0028, Score: 0.0648) | Inst IOU: 0.4588 | Mean IOU: 0.4806 | Elapsed: 00:04:32 | ETR: 00:09:01
Iter 290/1000 | Loss: 0.0082 (Seg: 0.0066, Score: 0.0327) | Inst IOU: 0.5160 | Mean IOU: 0.4865 | Elapsed: 00:04:44 | ETR: 00:13:09
Iter 300/1000 | Loss: 0.0046 (Seg: 0.0033, Score: 0.0277) | Inst IOU: 0.5338 | Mean IOU: 0.4920 | Elapsed: 00:04:52 | ETR: 00:10:02
Iter 310/1000 | Loss: 0.0058 (Seg: 0.0033, Score: 0.0505) | Inst IOU: 0.5107 | Mean IOU: 0.4953 | Elapsed: 00:05:01 | ETR: 00:10:16
Iter 320/1000 | Loss: 0.0044 (Seg: 0.0031, Score: 0.0267) | Inst IOU: 0.5477 | Mean IOU: 0.5012 | Elapsed: 00:05:11 | ETR: 00:11:29
Iter 330/1000 | Loss: 0.0195 (Seg: 0.0115, Score: 0.1613) | Inst IOU: 0.3761 | Mean IOU: 0.5072 | Elapsed: 00:05:23 | ETR: 00:13:07
Iter 340/1000 | Loss: 0.0142 (Seg: 0.0085, Score: 0.1140) | Inst IOU: 0.4529 | Mean IOU: 0.5090 | Elapsed: 00:05:34 | ETR: 00:11:46
Iter 350/1000 | Loss: 0.0051 (Seg: 0.0035, Score: 0.0310) | Inst IOU: 0.5879 | Mean IOU: 0.5108 | Elapsed: 00:05:44 | ETR: 00:10:53
Iter 360/1000 | Loss: 0.0098 (Seg: 0.0069, Score: 0.0572) | Inst IOU: 0.4754 | Mean IOU: 0.5112 | Elapsed: 00:05:52 | ETR: 00:08:36
Iter 370/1000 | Loss: 0.0055 (Seg: 0.0022, Score: 0.0671) | Inst IOU: 0.5813 | Mean IOU: 0.5135 | Elapsed: 00:06:02 | ETR: 00:10:56
Iter 380/1000 | Loss: 0.0049 (Seg: 0.0030, Score: 0.0393) | Inst IOU: 0.5189 | Mean IOU: 0.5159 | Elapsed: 00:06:12 | ETR: 00:10:31
Iter 390/1000 | Loss: 0.0052 (Seg: 0.0039, Score: 0.0268) | Inst IOU: 0.5257 | Mean IOU: 0.5201 | Elapsed: 00:06:22 | ETR: 00:09:18
Iter 400/1000 | Loss: 0.0108 (Seg: 0.0086, Score: 0.0431) | Inst IOU: 0.5049 | Mean IOU: 0.5206 | Elapsed: 00:06:31 | ETR: 00:09:47
Iter 410/1000 | Loss: 0.0035 (Seg: 0.0021, Score: 0.0271) | Inst IOU: 0.5465 | Mean IOU: 0.5212 | Elapsed: 00:06:42 | ETR: 00:10:36
Iter 420/1000 | Loss: 0.0063 (Seg: 0.0042, Score: 0.0421) | Inst IOU: 0.4463 | Mean IOU: 0.5216 | Elapsed: 00:06:53 | ETR: 00:10:22
Iter 430/1000 | Loss: 0.0065 (Seg: 0.0025, Score: 0.0791) | Inst IOU: 0.6379 | Mean IOU: 0.5270 | Elapsed: 00:07:02 | ETR: 00:08:55
Iter 440/1000 | Loss: 0.0038 (Seg: 0.0022, Score: 0.0315) | Inst IOU: 0.5800 | Mean IOU: 0.5297 | Elapsed: 00:07:12 | ETR: 00:09:02
Iter 450/1000 | Loss: 0.0037 (Seg: 0.0021, Score: 0.0315) | Inst IOU: 0.5921 | Mean IOU: 0.5336 | Elapsed: 00:07:23 | ETR: 00:10:29
Iter 460/1000 | Loss: 0.0173 (Seg: 0.0117, Score: 0.1128) | Inst IOU: 0.4427 | Mean IOU: 0.5326 | Elapsed: 00:07:33 | ETR: 00:08:30
Iter 470/1000 | Loss: 0.0052 (Seg: 0.0019, Score: 0.0656) | Inst IOU: 0.6329 | Mean IOU: 0.5332 | Elapsed: 00:07:41 | ETR: 00:07:32
Iter 480/1000 | Loss: 0.0104 (Seg: 0.0064, Score: 0.0807) | Inst IOU: 0.4425 | Mean IOU: 0.5349 | Elapsed: 00:07:51 | ETR: 00:08:23
Iter 490/1000 | Loss: 0.0063 (Seg: 0.0043, Score: 0.0403) | Inst IOU: 0.4942 | Mean IOU: 0.5368 | Elapsed: 00:08:02 | ETR: 00:09:01
Iter 500/1000 | Loss: 0.0060 (Seg: 0.0047, Score: 0.0253) | Inst IOU: 0.4981 | Mean IOU: 0.5356 | Elapsed: 00:08:11 | ETR: 00:07:59
Iter 510/1000 | Loss: 0.0065 (Seg: 0.0029, Score: 0.0714) | Inst IOU: 0.6319 | Mean IOU: 0.5373 | Elapsed: 00:08:21 | ETR: 00:07:48
Iter 520/1000 | Loss: 0.0053 (Seg: 0.0026, Score: 0.0539) | Inst IOU: 0.6211 | Mean IOU: 0.5397 | Elapsed: 00:08:30 | ETR: 00:07:15
Iter 530/1000 | Loss: 0.0046 (Seg: 0.0023, Score: 0.0450) | Inst IOU: 0.5489 | Mean IOU: 0.5441 | Elapsed: 00:08:39 | ETR: 00:06:54
Iter 540/1000 | Loss: 0.0047 (Seg: 0.0026, Score: 0.0406) | Inst IOU: 0.5494 | Mean IOU: 0.5439 | Elapsed: 00:08:47 | ETR: 00:06:23
Iter 550/1000 | Loss: 0.0049 (Seg: 0.0033, Score: 0.0323) | Inst IOU: 0.6185 | Mean IOU: 0.5459 | Elapsed: 00:08:58 | ETR: 00:08:25
Iter 560/1000 | Loss: 0.0123 (Seg: 0.0071, Score: 0.1038) | Inst IOU: 0.4703 | Mean IOU: 0.5456 | Elapsed: 00:09:05 | ETR: 00:05:15
Iter 570/1000 | Loss: 0.0069 (Seg: 0.0025, Score: 0.0877) | Inst IOU: 0.6533 | Mean IOU: 0.5460 | Elapsed: 00:09:14 | ETR: 00:05:58
Iter 580/1000 | Loss: 0.0109 (Seg: 0.0093, Score: 0.0325) | Inst IOU: 0.5137 | Mean IOU: 0.5461 | Elapsed: 00:09:23 | ETR: 00:06:12
Iter 590/1000 | Loss: 0.0047 (Seg: 0.0030, Score: 0.0330) | Inst IOU: 0.5902 | Mean IOU: 0.5460 | Elapsed: 00:09:31 | ETR: 00:05:57
Iter 600/1000 | Loss: 0.0046 (Seg: 0.0027, Score: 0.0377) | Inst IOU: 0.5858 | Mean IOU: 0.5481 | Elapsed: 00:09:40 | ETR: 00:05:38
Iter 610/1000 | Loss: 0.0056 (Seg: 0.0036, Score: 0.0388) | Inst IOU: 0.5016 | Mean IOU: 0.5479 | Elapsed: 00:09:51 | ETR: 00:07:14
Iter 620/1000 | Loss: 0.0042 (Seg: 0.0023, Score: 0.0378) | Inst IOU: 0.6087 | Mean IOU: 0.5478 | Elapsed: 00:10:01 | ETR: 00:06:01
Iter 630/1000 | Loss: 0.0041 (Seg: 0.0020, Score: 0.0425) | Inst IOU: 0.6147 | Mean IOU: 0.5484 | Elapsed: 00:10:10 | ETR: 00:06:04
Iter 640/1000 | Loss: 0.0044 (Seg: 0.0022, Score: 0.0428) | Inst IOU: 0.6160 | Mean IOU: 0.5503 | Elapsed: 00:10:18 | ETR: 00:04:45
Iter 650/1000 | Loss: 0.0031 (Seg: 0.0022, Score: 0.0184) | Inst IOU: 0.6033 | Mean IOU: 0.5522 | Elapsed: 00:10:26 | ETR: 00:04:30
Iter 660/1000 | Loss: 0.0060 (Seg: 0.0033, Score: 0.0522) | Inst IOU: 0.5386 | Mean IOU: 0.5519 | Elapsed: 00:10:37 | ETR: 00:05:56
Iter 670/1000 | Loss: 0.0058 (Seg: 0.0046, Score: 0.0251) | Inst IOU: 0.5265 | Mean IOU: 0.5524 | Elapsed: 00:10:48 | ETR: 00:06:07
Iter 680/1000 | Loss: 0.0085 (Seg: 0.0070, Score: 0.0312) | Inst IOU: 0.5196 | Mean IOU: 0.5514 | Elapsed: 00:10:57 | ETR: 00:04:54
Iter 690/1000 | Loss: 0.0053 (Seg: 0.0020, Score: 0.0649) | Inst IOU: 0.6328 | Mean IOU: 0.5551 | Elapsed: 00:11:08 | ETR: 00:05:34
Iter 700/1000 | Loss: 0.0039 (Seg: 0.0031, Score: 0.0161) | Inst IOU: 0.5977 | Mean IOU: 0.5569 | Elapsed: 00:11:18 | ETR: 00:05:15
Iter 710/1000 | Loss: 0.0052 (Seg: 0.0031, Score: 0.0422) | Inst IOU: 0.5516 | Mean IOU: 0.5558 | Elapsed: 00:11:25 | ETR: 00:03:16
Iter 720/1000 | Loss: 0.0062 (Seg: 0.0053, Score: 0.0182) | Inst IOU: 0.5687 | Mean IOU: 0.5575 | Elapsed: 00:11:36 | ETR: 00:05:04
Iter 730/1000 | Loss: 0.0038 (Seg: 0.0025, Score: 0.0253) | Inst IOU: 0.5647 | Mean IOU: 0.5578 | Elapsed: 00:11:45 | ETR: 00:04:20
Iter 740/1000 | Loss: 0.0041 (Seg: 0.0031, Score: 0.0192) | Inst IOU: 0.5958 | Mean IOU: 0.5586 | Elapsed: 00:11:54 | ETR: 00:03:50
Iter 750/1000 | Loss: 0.0056 (Seg: 0.0037, Score: 0.0368) | Inst IOU: 0.5802 | Mean IOU: 0.5575 | Elapsed: 00:12:03 | ETR: 00:03:32
Iter 760/1000 | Loss: 0.0031 (Seg: 0.0021, Score: 0.0205) | Inst IOU: 0.6008 | Mean IOU: 0.5577 | Elapsed: 00:12:12 | ETR: 00:03:47
Iter 770/1000 | Loss: 0.0040 (Seg: 0.0027, Score: 0.0259) | Inst IOU: 0.5794 | Mean IOU: 0.5602 | Elapsed: 00:12:21 | ETR: 00:03:29
Iter 780/1000 | Loss: 0.0030 (Seg: 0.0020, Score: 0.0193) | Inst IOU: 0.5944 | Mean IOU: 0.5623 | Elapsed: 00:12:30 | ETR: 00:03:18
Iter 790/1000 | Loss: 0.0048 (Seg: 0.0019, Score: 0.0589) | Inst IOU: 0.6777 | Mean IOU: 0.5668 | Elapsed: 00:12:42 | ETR: 00:03:55
Iter 800/1000 | Loss: 0.0141 (Seg: 0.0093, Score: 0.0955) | Inst IOU: 0.4931 | Mean IOU: 0.5670 | Elapsed: 00:12:52 | ETR: 00:03:31
Iter 810/1000 | Loss: 0.0039 (Seg: 0.0031, Score: 0.0151) | Inst IOU: 0.6085 | Mean IOU: 0.5685 | Elapsed: 00:13:04 | ETR: 00:03:52
Iter 820/1000 | Loss: 0.0133 (Seg: 0.0097, Score: 0.0726) | Inst IOU: 0.5025 | Mean IOU: 0.5679 | Elapsed: 00:13:14 | ETR: 00:02:59
Iter 830/1000 | Loss: 0.0038 (Seg: 0.0029, Score: 0.0175) | Inst IOU: 0.5875 | Mean IOU: 0.5681 | Elapsed: 00:13:25 | ETR: 00:03:06
Iter 840/1000 | Loss: 0.0094 (Seg: 0.0074, Score: 0.0407) | Inst IOU: 0.5929 | Mean IOU: 0.5701 | Elapsed: 00:13:35 | ETR: 00:02:35
Iter 850/1000 | Loss: 0.0068 (Seg: 0.0047, Score: 0.0418) | Inst IOU: 0.5025 | Mean IOU: 0.5697 | Elapsed: 00:13:44 | ETR: 00:02:16
Iter 860/1000 | Loss: 0.0081 (Seg: 0.0048, Score: 0.0665) | Inst IOU: 0.6250 | Mean IOU: 0.5733 | Elapsed: 00:13:55 | ETR: 00:02:26
Iter 870/1000 | Loss: 0.0032 (Seg: 0.0021, Score: 0.0215) | Inst IOU: 0.6090 | Mean IOU: 0.5712 | Elapsed: 00:14:02 | ETR: 00:01:34
Iter 880/1000 | Loss: 0.0075 (Seg: 0.0063, Score: 0.0241) | Inst IOU: 0.5870 | Mean IOU: 0.5753 | Elapsed: 00:14:13 | ETR: 00:02:15
Iter 890/1000 | Loss: 0.0025 (Seg: 0.0018, Score: 0.0143) | Inst IOU: 0.6086 | Mean IOU: 0.5793 | Elapsed: 00:14:24 | ETR: 00:01:55
Iter 900/1000 | Loss: 0.0033 (Seg: 0.0022, Score: 0.0222) | Inst IOU: 0.5891 | Mean IOU: 0.5796 | Elapsed: 00:14:34 | ETR: 00:01:47
Iter 910/1000 | Loss: 0.0096 (Seg: 0.0036, Score: 0.1188) | Inst IOU: 0.4333 | Mean IOU: 0.5766 | Elapsed: 00:14:44 | ETR: 00:01:24
Iter 920/1000 | Loss: 0.0095 (Seg: 0.0071, Score: 0.0487) | Inst IOU: 0.5166 | Mean IOU: 0.5769 | Elapsed: 00:14:54 | ETR: 00:01:21
Iter 930/1000 | Loss: 0.0039 (Seg: 0.0022, Score: 0.0342) | Inst IOU: 0.6163 | Mean IOU: 0.5772 | Elapsed: 00:15:05 | ETR: 00:01:16
Iter 940/1000 | Loss: 0.0056 (Seg: 0.0044, Score: 0.0245) | Inst IOU: 0.5736 | Mean IOU: 0.5744 | Elapsed: 00:15:12 | ETR: 00:00:40
Iter 950/1000 | Loss: 0.0039 (Seg: 0.0024, Score: 0.0308) | Inst IOU: 0.5368 | Mean IOU: 0.5733 | Elapsed: 00:15:23 | ETR: 00:00:55
Iter 960/1000 | Loss: 0.0038 (Seg: 0.0022, Score: 0.0311) | Inst IOU: 0.5626 | Mean IOU: 0.5746 | Elapsed: 00:15:32 | ETR: 00:00:36
Iter 970/1000 | Loss: 0.0090 (Seg: 0.0061, Score: 0.0591) | Inst IOU: 0.5202 | Mean IOU: 0.5756 | Elapsed: 00:15:41 | ETR: 00:00:27
Iter 980/1000 | Loss: 0.0030 (Seg: 0.0020, Score: 0.0199) | Inst IOU: 0.6019 | Mean IOU: 0.5768 | Elapsed: 00:15:49 | ETR: 00:00:17
Iter 990/1000 | Loss: 0.0032 (Seg: 0.0024, Score: 0.0153) | Inst IOU: 0.6136 | Mean IOU: 0.5789 | Elapsed: 00:15:59 | ETR: 00:00:10
--- Training Finished ---
Final model saved to ./finetuned_sam2_models/sam2_hiera_tiny_finetuned_decoder.pth